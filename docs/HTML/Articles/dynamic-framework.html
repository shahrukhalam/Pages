<!DOCTYPE html>
<html>
<head>
    <title> Dynamic Library in iOS </title>
    <meta charset="UTF-8">
    <meta name="author" content="Shahrukh Alam">
    <meta name="description" content="Short article on Static vs Dynamic Libraries in iOS">
    <meta name="keywords" content="Static Library, Dynamic Library, Static Framework, Dynamic Framework, Static vs Dynamic Library, Static vs Dynamic Framework, Static vs Dynamic Library in iOS, Static vs Dynamic Framework in iOS">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:title" content="How Jesse Pinkman Cracked Dynamic Library in iOS (Part 1)">
    <meta name="twitter:title" content="How Jesse Pinkman Cracked Dynamic Library in iOS (Part 1)">
    <meta property="og:description" content="Short article on Static vs Dynamic Libraries in iOS">
    <meta name="twitter:description" content="Short article on Static vs Dynamic Libraries in iOS">
    <meta property="og:image" content="https://shahrukhalam.github.io/Pages/Images/Articles/Frameworks/Dynamic/xcframework.png">
    <meta name="twitter:image" content="https://shahrukhalam.github.io/Pages/Images/Articles/Frameworks/Dynamic/xcframework.png">
    <meta property="og:url" content="https://shahrukhalam.github.io/Pages/HTML/Articles/dynamic-framework">
    <meta name="twitter:url" content="https://shahrukhalam.github.io/Pages/HTML/Articles/dynamic-framework">
    <link rel="icon" type="image/png" href="/Pages/Images/Index/favicon.png">
    <link rel="stylesheet" href="/Pages/CSS/kickoff.css">
    <link rel="stylesheet" href="/Pages/CSS/nav.css">
    <link rel="stylesheet" href="/Pages/CSS/body.css">
    <link rel="stylesheet" href="/Pages/CSS/common.css">
    <link rel="stylesheet" media="screen and (min-width: 900px)" href="/Pages/CSS/font.css">
    <link rel="stylesheet" media="screen and (max-width: 900px)" href="/Pages/CSS/font-small.css">
    <link rel="stylesheet" href="/Pages/CSS/article.css">
    <link rel="stylesheet" media="screen and (min-width: 900px)" href="/Pages/CSS/markdown.css">
    <link rel="stylesheet" media="screen and (max-width: 900px)" href="/Pages/CSS/markdown-small.css">
    <link rel="stylesheet" href="/Pages/CSS/source.css">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7Y1NP7BQPP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7Y1NP7BQPP');
    </script>
</head>
<body>
        <div class="indexNav">
            <a href="/Pages/index" class="inactiveLink">
            Home
            </a>
            <a href="/Pages/HTML/Articles/dynamic-framework" class="activeLink">
            Articles
            </a>
            <hr style="background-color: rgba(76, 76, 76, 1.0);height: 1px;border-width: 0px;">
        </div>
        <div class="article">
            <div class="markdown">
                <div>
                    <h1>How Jesse Pinkman Cracked Dynamic Library in iOS (Part 1)</h1>
                    <p class="intro">Are you Duplicating a piece of code for a particular functionality across multiple Apps? Do you find it difficult to fix a bug in all those places? If Yes, then Dynamic Library is an answer to your problems.</p>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/breaking-bad.jpeg" alt="Breaking Bad van in the desert">
                    <p class="imageCredits centerText">Breaking Bad Meth Van, Courtesy: <a href="https://www.artstation.com/artwork/XBmkGw">Artstation</a></p>
                    <p>This Article will be in the form of a questionnaire about Dynamic Library in iOS between <strong>Jesse Pinkman</strong> &amp; <strong>Heisenberg</strong>, fictional characters from the epic TV Series <a href="https://en.wikipedia.org/wiki/Breaking_Bad">Breaking Bad</a>. Those who haven't watched it, Walter White (aka Heisenberg) is like a mentor to Jesse Pinkman, but for all the unconventional things.</p>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>Yo, knock knock!</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>Who is there?</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>It‚Äôs You, Bi</em>ch ü§£ (if you remember ‚ÄúI am the one who knocks‚Äù)*</p>
                    </blockquote>
                    <blockquote>
                    <p><strong>Heisenberg:</strong> <em>Haha, Say my Name! üòé</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>Yo, just kidding. Should we start?</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>Yeah, we should. I don‚Äôt have much time left anyway ü§¢</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>What‚Äôs a Library, let alone Dynamic?</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>Please check out Static Library in iOS about Library &amp; Static Linking before you continue.</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>Okay, got it. Now, How Dynamic Library is different from it‚Äôs Static Counterpart?</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>The key differences between Static &amp; Dynamic Libraries (Dylib) are:</em></p>
                    </blockquote>
                    <h2>Linking</h2>
                    <h3>Static</h3>
                    <ul>
                    <li>When an app is linked with a static library, the library code that the app uses is directly copied to the generated App Executable by <a href="https://en.wikipedia.org/wiki/Linker_(computing)">Static Linker</a>.</li>
                    </ul>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/static-linking.png" alt="Flow diagram of static linking">
                    <p class="imageCredits centerText">App using static libraries, Courtesy: <a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html">Apple</a></p>
                    <h3>Dynamic</h3>
                    <ul>
                    <li>When an app is using a dynamic library, only the References (rather Names to be precise) of the library is placed in the App Executable by Static Linker.</li>
                    <li>Actual linking takes place at launch time or at run time by <a href="https://en.wikipedia.org/wiki/Dynamic_linker">Dynamic Linker</a>, when both app executable and dynamic library are placed in the memory.</li>
                    </ul>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/dynamic-linking.png" alt="Flow diagram of dynamic linking">
                    <p class="imageCredits centerText">App using dynamic libraries, Courtesy: <a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html">Apple</a></p>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/dynamic-linking-explained.png" alt="Flow diagram explaining dynamic linking">
                    <p class="imageCredits centerText">Flow diagram explaining dynamic linking</p>
                    <h2>Launch Times and Memory Footprints</h2>
                    <h3>Static</h3>
                    <ul>
                    <li>As the library code gets copied directly to the App Executable, linking many static libraries into an app produces large app executable file.</li>
                    <li>Applications with large executables suffer from slow launch times and large memory footprints.</li>
                    </ul>
                    <h3>Dynamic (aka Dynamically Linked Libraries or DLL)</h3>
                    <ul>
                    <li>It‚Äôs code is loaded (and linked) into an app‚Äôs address space when it‚Äôs actually needed, either at launch time or at run time.</li>
                    <li>Run time Linking offers faster launch times &amp; less memory footprints.</li>
                    </ul>
                    <h2>Sharing</h2>
                    <h3>Static</h3>
                    <ul>
                    <li>Let‚Äôs say some improvements were added in the version 1.0.1 of Static Library from 1.0.0</li>
                    <li>Let‚Äôs say latest app version is 1.0 which will have the code of Static Library version 1.0.0</li>
                    <li>Now, in order to gain access to the improved functionality, the app developers must recompile &amp; relink the object files of the app with the new version 1.0.1 of the library, also they would have to release a new version (say 1.1) of the app.</li>
                    <li>Also the app users need to update their app with the latest version 1.1</li>
                    <li>So, to keep an app updated with the latest functionalities, some work is needed from both the app developers &amp; the end users.</li>
                    </ul>
                    <h3>Dynamic (aka Dynamic Shared Libraries or DSL):</h3>
                    <ul>
                    <li>Several programs(Apps) use a single shared copy of an executable dynamic library module.
                    For example, a single copy of AppKit (UIKit, but for Mac OS) resides on the System &amp; all the Apps point to the same.</li>
                    <li>This significantly reduces the size of the app executable, saving memory and disk space.</li>
                    <li>App load time will be further reduced if the shared library code is already present in memory.</li>
                    <li>Programs can benefit from improvements to the dynamic libraries they use automatically without requiring app developers to <strong>recompile</strong> the apps.
                    This is how apps that use Cocoa technologies benefit from improvements to Mac OS as all system libraries in Mac OS are dynamic.</li>
                    <li>When I say <em>recompile</em> (from the previous point), I mean let‚Äôs say we have an App version 1.0 using AppKit dynamic library version 1.0.0
                    Our App executable keeps a reference (just the Name) to the AppKit.
                    Now, we got an OS update &amp; AppKit version is bumped to 1.0.1 on the File System.</li>
                    </ul>
                    <p><a href="https://en.wikipedia.org/wiki/Dynamic_linker">Dynamic Loader</a> sees our App executable &amp; finds the name AppKit to load. As long as AppKit is present (and is compatible, which it will be in most cases) in the File System, Dynamic Loader will be able to load it, the version of AppKit doesn‚Äôt matter. We don‚Äôt need to do anything extra &amp; we get the new version 1.0.1 for free.</p>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/static-vs-dynamic.png" alt="Flow diagram explaining static vs dynamic load">
                    <p class="imageCredits centerText">Flow diagram explaining static vs dynamic load</p>
                    <h2>Run time Speed</h2>
                    <p>Programs that use dynamic libraries are slower at run time than those using statically-linked libraries, especially when app is trying to link the dynamic library module at run time.</p>
                    <p>This is a fair trade off for faster launch times &amp; less memory footprints.</p>
                    <h2>Compatibility</h2>
                    <h3>Static</h3>
                    <ul>
                    <li>In statically-linked programs, all code is contained in a single executable module. Therefore, they never run into compatibility issues.</li>
                    </ul>
                    <h3>Dynamic</h3>
                    <ul>
                    <li>One issue that developers must keep in mind when developing dynamic libraries is maintaining compatibility with client apps as a library is updated.<br />
                    Let‚Äôs say Mac Apps <em>AdobePhotoshop</em> version 1.0 &amp; <em>AdobeIllustrator</em> version 1.0 both use the shared dynamic library <em>AdobeCore</em> version 1.0.0<br />
                    Now, Adobe developers decide to release a new version 1.0.1 for <em>AdobeCore</em> alone.<br />
                    They have to do a backward compatibility check for <em>AdobePhotoshop</em> 1.0 &amp; <em>AdobeIllustrator</em> 1.0 as both the apps will now be pointing to <em>AdobeCore</em> 1.0.1, if any compatibility issue arises Dynamic Loader will terminate the process (app) at launch time or run time.</li>
                    <li>Because a library can be updated without the knowledge of the client-app‚Äôs developer, the app must be able to use the new version of the library without changes to its code. To that end, the library‚Äôs API should not change.</li>
                    <li>However, there are times when improvements require API changes. In that case, the previous version of the library must remain in the user‚Äôs computer for the client app to run properly.<br />
                    Continuing the previous example, Adobe developers can release <em>AdobeCore</em> 1.0.1 keeping <em>AdobeCore</em> 1.0.0 also in the System, so that <em>AdobePhotoshop</em> 1.0 &amp; <em>AdobeIllustrator</em> 1.0 can still use <em>AdobeCore</em> 1.0.0 without crashing &amp; latest <em>AdobePhotoshop</em> (say 1.1) &amp; <em>AdobeIllustrator</em> (say 1.1) can point to <em>AdobeCore</em> 1.0.1 benefitting from the improvements.</li>
                    <li>A new compiler release may change a library, applications might have to be reworked to be made compatible with the new version of the library.</li>
                    </ul>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>In the previous section, it was mentioned that standard locations for dynamic library are ~/lib, /usr/local/lib &amp; /usr/lib. Show me üòé</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>Okay, I will show few dylibs location on my system, it might be different on your file system.</em></p>
                    </blockquote>
                    <ol>
                    <li>Core Swift libraries, used by our Swift Apps are in <em>Library</em></li>
                    </ol>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/core-swift-dylib.png" alt="Swift Dynamic libaries in Finder">
                    <p class="imageCredits centerText">Swift Dynamic libaries in Finder</p>
                    <ol start="2">
                    <li>Helper Swift libraries, used by <em>swiftc</em> (Swift Compiler) &amp; Xcode are in <em>User Library</em></li>
                    </ol>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/helper-swift-lib.png" alt="Swift helper libaries in Finder">
                    <p class="imageCredits centerText">Swift helper libaries in Finder</p>
                    <ol start="3">
                    <li>Locations of all the dylibs used by your App<br />
                    You can use <a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/LoggingDynamicLoaderEvents.html">Logging Dynamic Loader Events</a> Environment Variables on <em>Xcode -&gt; Active Scheme -&gt; Edit Scheme</em> like this:</li>
                    </ol>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/dylib-print-libraries.png" alt="Xcode Dylib print libraries">
                    <p class="imageCredits centerText">Xcode Dylib print libraries Settings</p>
                    <p>It will give an output like this for an empty single view iOS App on Debugger console:</p>
                    <img class="imageFullWidth" src="../../Images/Articles/Frameworks/Dynamic/dylib-print-libraries-output.png" alt="Xcode Dylib print libraries output">
                    <p class="imageCredits centerText">Xcode Dylib print libraries output</p>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>In the previous section, it was mentioned that Dynamic Libraries are loaded at launch time or run time. What‚Äôs the difference between them?</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>I appreciate how you are trying to be a good learner ü§™</em></p>
                    </blockquote>
                    <h3>Launch Time</h3>
                    <p>When you tap on that App Icon in your iPhone, app binary gets loaded onto memory along with the dynamic libraries required only for showing the launch screen &amp; then the first screen. It‚Äôs the time between the <em>main</em> function call of the executable &amp; the <em>return true</em> from <em>didFinishLaunchingWithOptions</em> of the AppDelegate. App state transitions from <em>terminated</em> to <em>active</em> during this time.</p>
                    <h3>Run Time</h3>
                    <p>It‚Äôs the time when the app is actually running &amp; user is interacting with it, dynamic libraries can also be loaded during this time based on the need of a particular module. It‚Äôs post Launch Time, the time between the <em>return true</em> from <em>didFinishLaunchingWithOptions</em> &amp; the <em>applicationWillTerminate</em> of the AppDelegate. App state transitions from <em>active</em> to <em>terminated</em> post this time.</p>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>Okay, can we now create a Dynamic Library for iOS?</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>Actually, true Dynamic Libraries are not supported in iOS ü§£</em></p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Jesse:</strong></em> <em>Then, why the f</em>ck were you telling me all this, and what is this true Dynamic Library now?*</p>
                    </blockquote>
                    <blockquote>
                    <p><em><strong>Heisenberg:</strong></em> <em>I understand that it‚Äôs frustrating, but you can‚Äôt make <a href="https://en.wikipedia.org/wiki/Methamphetamine">Meth</a> without knowing little bit of <a href="https://en.wikipedia.org/wiki/Periodic_table">Periodic table</a> stuff.</em></p>
                    </blockquote>
                    <p>And we will meet with rest of your curiosity in the next cracking session (Part 2). I know that I am leaving you on a cliffhanger &amp; it‚Äôs not fair, but neither is Life üòú</p>
                    <p>That‚Äôs enough for now, until next time‚Ä¶</p>
                </div>
                <div>
                    <p>
                    Thanks for reading üöÄ<br>If you liked this article, please share it with your friends and fellow iOS Developers üôè
                    </p>
                    <a href="https://twitter.com/intent/tweet?text=I recommend Dynamic Library in iOS by Shahrukh Alam https://shahrukhalam.github.io/Pages/HTML/Articles/dynamic-framework" style="display: block;" target="_blank">
                        <img src="/Pages/Images/Articles/twitter.png" alt="">
                        <p style="display: inline;">
                        Share this article on Twitter
                        </p>
                    </a>
                    <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://shahrukhalam.github.io/Pages/HTML/Articles/dynamic-framework" style="display: block;" target="_blank">
                        <img src="/Pages/Images/Articles/linkedin.png" alt="">
                        <p style="display: inline;">
                        Share this article on Linkedin
                        </p>
                    </a>
                </div>
            </div>
        </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js">  </script>
    <script> hljs.highlightAll(); </script>
</body>
</html>